# 更新日志

## [4.5.0] - 2024-12-19

### 🎯 重大修复
- **修复设备实体不自动创建的问题**: 彻底解决了设备发现后实体不生成的核心问题
- **修复常量定义错误**: 解决了`OP_RESP_DEVICE_LIST`未定义的错误

### ✨ 新功能
- **动态实体创建**: 设备发现后自动创建对应的Home Assistant实体
- **实时设备同步**: 点击"亖米读取设备列表"后立即生成所有设备实体
- **智能防重复**: 自动防止重复创建相同设备的实体
- **多通道支持**: 自动为多通道设备创建独立的控制实体

### 🔧 技术改进
- 重构了实体平台的设备发现机制
- 优化了协调器的设备状态同步
- 改进了TCP通信协议解析
- 增强了错误处理和日志记录
- 完善了设备管理器的设备跟踪

### 📊 支持的实体类型
- **开关实体**: 单通道和多通道开关设备
- **灯光实体**: 支持调光和色温控制
- **二进制传感器**: 门磁、人体感应等传感器

### 🐛 修复的问题
- 修复了设备列表读取后实体不创建的问题
- 修复了常量导入错误导致的帧处理失败
- 修复了设备发现回调机制的异步处理问题
- 修复了多通道设备实体创建逻辑

## [4.4.0] - 2024-12-19

### 🔧 技术改进
- 初步实现动态实体创建机制
- 改进设备发现回调处理

## [4.3.2] - 2024-12-19

### 🐛 修复
- 修复TCP通信稳定性问题
- 优化设备状态同步机制

## [4.3.1] - 2024-12-19

### 🔧 改进
- 优化设备发现流程
- 改进错误处理机制

## [4.3.0] - 2024-12-19

### ✨ 新功能
- 添加设备自动发现功能
- 支持TCP和串口双模式连接
- 实现设备状态实时同步

### 🎯 支持的设备
- 零火开关 (1-6路)
- 单火开关 (1-4路)
- 智能灯具
- 门磁传感器
- 人体感应传感器
- 智能插座

### 🔧 技术特性
- 完整的协议栈实现
- 设备持久化存储
- 异步通信处理
- 错误恢复机制
